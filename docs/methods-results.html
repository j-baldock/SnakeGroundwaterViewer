<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Methods and Results – Groundwater Availability in the upper Snake River Watershed</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./springprevalence.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c599ca7844cfd5ff950332d51a54001f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-a0800d32663627e31cbe2a42d8010cbb.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-c599ca7844cfd5ff950332d51a54001f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean"
}
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
</head><body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script><a href="https://github.com/j-baldock/SnakeGroundwaterViewer" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#69b3a2; color:#fff; position: 

absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 

L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 

C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 

125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 

130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 

119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 

C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 

178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 

216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 

C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 

C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover 

.octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes 

octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media 

(max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner 

  .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>






<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./methods-results.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Methods and Results</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Groundwater Availability in the upper Snake River Watershed</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./methods-results.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Methods and Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./springprevalence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">View Spring Prevalence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./groundwaterindex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">View Groundwater Index</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#methods" id="toc-methods" class="nav-link active" data-scroll-target="#methods"><span class="header-section-number">2.1</span> Methods</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">2.2</span> Results</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">2.3</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Methods and Results</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Below is a detailed description of the methods used to generate the index of groundwater availability and the associated results. These are copied from the associated publication.</p>
<section id="methods" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="methods"><span class="header-section-number">2.1</span> Methods</h2>
<p>Field observations suggested that the location of groundwater discharge to streams (i.e., springs) could be predicted based on geology and topography alone (Pourtaghi and Pourghasemi 2014, Leach et al.&nbsp;2017). We therefore used MaxEnt version 3.4.4 (Phillips and Dudík 2008, Elith et al.&nbsp;2011; <a href="https://biodiversityinformatics.amnh.org/open_source/maxent/" class="uri">https://biodiversityinformatics.amnh.org/open_source/maxent/</a>, accessed on 17 July 2023), a presence-only machine learning technique, to predict the prevalence of springs throughout the USRW (Gerlach et al.&nbsp;2022). Between 2019 and 2023, we opportunistically collected 105 GPS locations of springs. We identified springs as either (1) areas where water actively upwelled from surface substratum within riparian and floodplain areas or (2) locations where water flowed laterally out of a hillside, typically at valley-bottom toeslopes (floodplain and upland hillslope springs, respectively, sensu Stevens et al.&nbsp;2021). We combined field observations with 77 additional locations downloaded from the Groundwater Atlas of Wyoming (<a href="https://portal.wsgs.wyo.gov/arcgis/apps/webappviewer/index.html?id=181c32a872a346bfae3579a62230a65a" class="uri">https://portal.wsgs.wyo.gov/arcgis/apps/webappviewer/index.html?id=181c32a872a346bfae3579a62230a65a</a>, accessed on 15 July 2023), filtered to remove hot springs as geothermal activity likely exerts different controls on stream ecosystems than “cold” groundwater inputs that were the focus of this study. Spring locations downloaded from the Groundwater Atlas of Wyoming were previously digitized from U.S. Geological Survey 1:100,000 scale topographic maps covering the state of Wyoming.</p>
<p>Following Gerlach et al.&nbsp;(2022), we modeled the prevalence of groundwater springs across the USRW using the 182 spring locations as presence points and 11 geologic and topographic layers as predictors. Geologic layers included bedrock and surficial geology (Love and Christiansen 1985), which are known to control both deep and shallow groundwater storage capacity (Tague et al.&nbsp;2007, O’Sullivan et al.&nbsp;2020, Dralle et al.&nbsp;2023), and distance to geologic lineaments (i.e., bedrock fractures), which are known to affect groundwater flow paths (Mallast et al.&nbsp;2011). Underlying geology interacts with topographic features to determine locations of groundwater discharge to streams. We used the DEM to extract elevation, slope, profile curvature, profile curvature range, planform curvature, planform curvature range, and terrain ruggedness index for the USRW (Gerlach et al.&nbsp;2022). Steep slopes may represent steep hydraulic gradients driving shallow groundwater flow (Haitjema and Mitchell-Bruker 2005). Profile curvature measures surface curvature parallel to the slope, while planform curvature measures surface curvature perpendicular to the slope. We calculated the range of profile and planform curvature and terrain ruggedness index within a 3 x 3 cell (ca. 30 x 30 m) window to measure variation in curvature over short distances and topographic heterogeneity, respectively. Curvature, curvature range, and terrain ruggedness index may indicate slope failures induced by groundwater discharge (Reid and Iverson 1992), stream headwaters formed by groundwater discharge (Jaeger et al.&nbsp;2007), and abrupt changes in slope where the water table may be close to the ground surface (Winter 2001, Detty and McGuire 2010). We used the curvature and tri functions in the R package spatialEco (Evans and Murphy 2023) to calculate curvature and terrain ruggedness and the focal function in the R package terra (Hijmans 2023) to calculate curvature range. Finally, we calculated distance to flowlines using the gDistance function in the R package rgeos (Bivand and Rundel 2023). Flowlines represent areas where the water table is near or above the ground surface (Winter 1999) and the upstream extent of flowlines is associated with stream headwaters formed by groundwater discharge (Jaeger et al.&nbsp;2007). Geologic layers and the DEM used to prepare topographic layers were accessed from the Wyoming Geospatial Hub on 17 July 2023 (<a href="https://data.geospatialhub.org/" class="uri">https://data.geospatialhub.org/</a>).</p>
<p>We modeled the prevalence of groundwater springs using a logistic model with the default parameters, except for a default prevalence value of 0.1, as we expected springs to be uncommon at the landscape scale. Of the 182 spring locations, 70% (n = 128) were used for model training and 30% (n = 54) were used for model testing. We did not test for or exclude predictor variables that were correlated as our primary goal was to build a model with high predictive accuracy, rather than to make inference on the effect of any single variable. We assessed model performance by calculating the area under the receiver operating curve (AUC): the probability that a randomly chosen presence point will be ranked above a randomly chosen background location (Phillips and Dudík 2008).</p>
<p>While accounting for spatial bias in search effort can help increase the accuracy of MaxEnt modeling (Kramer-Schadt et al.&nbsp;2013), we did not consider this necessary for three reasons. First, fieldwork over five years brought us to most areas within the USRW and we therefore did not think search effort was systematically biased towards certain locations. Second, combining field observations with the Groundwater Atlas of Wyoming increased our sample size of spring locations in high elevation, headwater areas that were difficult to access on foot. Third, the model output describing spring prevalence aligned well with our a priori understanding of groundwater activity in the region (refer to Study System and Species). Therefore, we considered the spatial clustering of spring locations to be a real pattern (sensu Winter 2001), rather than an artifact of unequal search effort.</p>
<p>From the MaxEnt model output (a raster of spring prevalence, where the value for each ca. 10 x 10 m cell represents the probability of the cell containing a groundwater spring), we derived a metric describing groundwater influence on stream conditions. We buffered (100 m radius) the prevalence raster to the stream network as we assumed only groundwater discharging from springs adjacent to flowlines exert influence on stream conditions, such as temperature. We then used WhiteboxTools to delineate catchments for 13,083 locations spaced every 300 m (the distance between study reaches) across the stream network (hereafter, network locations), 32 stream temperature monitoring locations, and 52 study reaches (the downstream extent of four reaches within each of the 13 focal streams). Deriving a metric of groundwater influence across the entire stream network was necessary to allow for projections of growth and production at this scale. We restricted network locations to those with catchments &lt;500 km2 as we assumed groundwater effects on ecosystem processes likely differ between large rivers and smaller tributary streams that were the focus of our study. For each watershed corresponding to either a network, temperature, or study location, we calculated a distance-weighted mean prevalence from the buffered spring prevalence raster. Our weighting scheme used inverse exponential weights with an e-folding distance (the distance at which the weight is 1/e) of 5 km (Isaak et al.&nbsp;2010). This approach assumes that springs located immediately upstream of a given point exert the greatest influence on local stream conditions, while springs located further upstream are exponentially less likely to affect conditions at the location of interest. To aid interpretation, we normalized the metric of groundwater influence to 0-1 based on the minimum and maximum values calculated for the 13,083 network locations. We used the normalized, distance-weighted mean spring prevalence within the contributing catchment to describe relative groundwater influence at each network, temperature, or study location (hereafter, groundwater index or GWI).</p>
</section>
<section id="results" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="results"><span class="header-section-number">2.2</span> Results</h2>
<p>The MaxEnt model describing groundwater spring prevalence performed well: model area under the curve (AUC) values were 0.93 for both training and testing data. In order of importance, spring prevalence was a function of distance to flowlines, bedrock geology, profile curvature range, surficial geology, elevation, and distance to geologic lineaments, with all other variables contributing little to no information (Table 1). Collectively, the model indicated that <strong><em>groundwater springs occurred near flowlines where topography changes abruptly over small distances in valley-bottom areas underlain by coarse glacial deposits</em></strong> (i.e., toe slopes formed by stream channel incision into unconsolidated alluvium and colluvium). While springs were predicted to be widespread throughout the upper Snake River watershed, they were most heavily concentrated in the southwestern, eastern, and northern portions of the study area, driving similar spatial patterns in derived GWI. Network locations with high GWI were rare at the scale of the upper Snake River watershed: locations with GWI &gt;0.5 represented just 2.8% of all locations for which the index was derived.</p>
</section>
<section id="references" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="references"><span class="header-section-number">2.3</span> References</h2>
<ul>
<li>Bivand, R., and C. Rundel. 2023. rgeos: Interface to Geometry Engine - Open Source (‘GEOS’). R package version 0.6-3, https://CRAN.R-project.org/package=rgeos.</li>
<li>Detty, J. M., and K. J. McGuire. 2010. Topographic controls on shallow groundwater dynamics: Implications of hydrologic connectivity between hillslopes and riparian zones in a till mantled catchment. Hydrological Processes 24:2222–2236.</li>
<li>Dralle, D. N., G. Rossi, P. Georgakakos, W. J. Hahm, D. M. Rempe, M. Blanchard, M. E. Power, W. E. Dietrich, and S. M. Carlson. 2023. The salmonid and the subsurface: Hillslope storage capacity determines the quality and distribution of fish habitat. Ecosphere 14:1–23.</li>
<li>Elith, J., S. J. Phillips, T. Hastie, M. Dudík, Y. E. Chee, and C. J. Yates. 2011. A statistical explanation of MaxEnt for ecologists. Diversity and Distributions 17:43–57.</li>
<li>Evans, J. S., and M. A. Murphy. 2023. spatialEco. R package version 2.0-1, https://github.com/jeffreyevans/spatialEco.</li>
<li>Gerlach, M. E., K. C. Rains, E. J. Guerrón-Orejuela, W. J. Kleindl, J. Downs, S. M. Landry, and M. C. Rains. 2022. Using remote sensing and machine learning to locate groundwater discharge to salmon-bearing streams. Remote Sensing 14.</li>
<li>Haitjema, H. M., and S. Mitchell-Bruker. 2005. Are water tables a subdued replica of the topography? Ground Water 43:781–786.</li>
<li>Hijmans, R. 2023. terra: Spatial Data Analysis. R package version 1.7-39, https://CRAN.R-project.org/package=terra.</li>
<li>Isaak, D. J., C. H. Luce, B. E. Rieman, D. E. Nagel, E. E. Peterson, D. L. Horan, S. Parkes, and G. L. Chandler. 2010. Effects of climate change and wildfire on stream temperatures and salmonid thermal habitat in a mountain river network. Ecological Applications 20:1350–1371.</li>
<li>Jaeger, K. L., D. R. Montgomery, and S. M. Bolton. 2007. Channel and perennial flow initiation in headwater streams: Management implications of variability in source-area size. Environmental Management 40:775–786.</li>
<li>Kramer-Schadt, S., J. Niedballa, J. D. Pilgrim, B. Schröder, J. Lindenborn, V. Reinfelder, M. Stillfried, I. Heckmann, A. K. Scharf, D. M. Augeri, S. M. Cheyne, A. J. Hearn, J. Ross, D. W. Macdonald, J. Mathai, J. Eaton, A. J. Marshall, G. Semiadi, R. Rustam, H. Bernard, R. Alfred, H. Samejima, J. W. Duckworth, C. Breitenmoser-Wuersten, J. L. Belant, H. Hofer, and A. Wilting. 2013. The importance of correcting for sampling bias in MaxEnt species distribution models. Diversity and Distributions 19:1366–1379.</li>
<li>Leach, J. A., W. Lidberg, L. Kuglerova, A. Peralta-Tapia, A. Agren, and H. Laudon. 2017. Evaluating topography-based predictions of shallow lateral groundwater discharge zones for a boreal lake-stream system. Water Resources Research 53:5420–5437.</li>
<li>Love, J. D., and A. C. Christiansen. 1985. Geologic map of Wyoming: U.S. Geological Survey Geologic Map, scale 1:500,000, 3 sheets.</li>
<li>Mallast, U., R. Gloaguen, S. Geyer, T. Rüdiger, and C. Siebert. 2011. Derivation of groundwater flow-paths based on semi-automatic extraction of lineaments from remote sensing data. Hydrology and Earth System Sciences 15:2665–2678.</li>
<li>O’Sullivan, A. M., K. J. Devito, J. Ogilvie, T. Linnansaari, T. Pronk, S. Allard, and R. A. Curry. 2020. Effects of Topographic Resolution and Geologic Setting on Spatial Statistical River Temperature Models. Water Resources Research 56:1–23.</li>
<li>Phillips, S. J., and M. Dudík. 2008. Modeling of species distributions with Maxent: new extensions and a comprehensive evaluation. Ecography 31:161–175.</li>
<li>Pourtaghi, Z. S., and H. R. Pourghasemi. 2014. GIS-based groundwater spring potential assessment and mapping in the Birjand Township, southern Khorasan Province, Iran. Hydrogeology Journal 22:643–662.</li>
<li>Reid, M. E., and R. M. Iverson. 1992. Gravity‐driven groundwater flow and slope failure potential: 2. Effects of slope morphology, material properties, and hydraulic heterogeneity. Water Resources Research 28:939–950.</li>
<li>Stevens, L. E., E. R. Schenk, and A. E. Springer. 2021. Springs ecosystem classification. Ecological Applications 31.</li>
<li>Tague, C., M. Farrell, G. Grant, S. Lewis, and S. Rey. 2007. Hydrogeologic controls on summer stream temperatures in the McKenzie River basin, Oregon. Hydrological Processes 21:3288–3300.</li>
<li>Winter, T. C. 1999. Relation of streams, lakes, and wetlands to groundwater flow systems. Hydrogeology Journal 7:28–45.</li>
<li>Winter, T. C. 2001. The concept of hydrologic landscapes. Journal of the American Water Resources Association 37:335–349.</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./springprevalence.html" class="pagination-link" aria-label="View Spring Prevalence">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">View Spring Prevalence</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb1" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Methods and Results"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Below is a detailed description of the methods used to generate the index of groundwater availability and the associated results. These are copied from the associated publication. </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">## Methods</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>Field observations suggested that the location of groundwater discharge to streams (i.e., springs) could be predicted based on geology and topography alone (Pourtaghi and Pourghasemi 2014, Leach et al. 2017). We therefore used MaxEnt version 3.4.4 (Phillips and Dudík 2008, Elith et al. 2011; <span class="ot">&lt;https://biodiversityinformatics.amnh.org/open_source/maxent/&gt;</span>, accessed on 17 July 2023), a presence-only machine learning technique, to predict the prevalence of springs throughout the USRW (Gerlach et al. 2022). Between 2019 and 2023, we opportunistically collected 105 GPS locations of springs. We identified springs as either (1) areas where water actively upwelled from surface substratum within riparian and floodplain areas or (2) locations where water flowed laterally out of a hillside, typically at valley-bottom toeslopes (floodplain and upland hillslope springs, respectively, sensu Stevens et al. 2021). We combined field observations with 77 additional locations downloaded from the Groundwater Atlas of Wyoming (<span class="ot">&lt;https://portal.wsgs.wyo.gov/arcgis/apps/webappviewer/index.html?id=181c32a872a346bfae3579a62230a65a&gt;</span>, accessed on 15 July 2023), filtered to remove hot springs as geothermal activity likely exerts different controls on stream ecosystems than “cold” groundwater inputs that were the focus of this study. Spring locations downloaded from the Groundwater Atlas of Wyoming were previously digitized from U.S. Geological Survey 1:100,000 scale topographic maps covering the state of Wyoming. </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>Following Gerlach et al. (2022), we modeled the prevalence of groundwater springs across the USRW using the 182 spring locations as presence points and 11 geologic and topographic layers as predictors. Geologic layers included bedrock and surficial geology (Love and Christiansen 1985), which are known to control both deep and shallow groundwater storage capacity (Tague et al. 2007, O’Sullivan et al. 2020, Dralle et al. 2023), and distance to geologic lineaments (i.e., bedrock fractures), which are known to affect groundwater flow paths (Mallast et al. 2011). Underlying geology interacts with topographic features to determine locations of groundwater discharge to streams. We used the DEM to extract elevation, slope, profile curvature, profile curvature range, planform curvature, planform curvature range, and terrain ruggedness index for the USRW (Gerlach et al. 2022). Steep slopes may represent steep hydraulic gradients driving shallow groundwater flow (Haitjema and Mitchell-Bruker 2005). Profile curvature measures surface curvature parallel to the slope, while planform curvature measures surface curvature perpendicular to the slope. We calculated the range of profile and planform curvature and terrain ruggedness index within a 3 x 3 cell (ca. 30 x 30 m) window to measure variation in curvature over short distances and topographic heterogeneity, respectively. Curvature, curvature range, and terrain ruggedness index may indicate slope failures induced by groundwater discharge (Reid and Iverson 1992), stream headwaters formed by groundwater discharge (Jaeger et al. 2007), and abrupt changes in slope where the water table may be close to the ground surface (Winter 2001, Detty and McGuire 2010). We used the curvature and tri functions in the R package spatialEco (Evans and Murphy 2023) to calculate curvature and terrain ruggedness and the focal function in the R package terra (Hijmans 2023) to calculate curvature range. Finally, we calculated distance to flowlines using the gDistance function in the R package rgeos (Bivand and Rundel 2023). Flowlines represent areas where the water table is near or above the ground surface (Winter 1999) and the upstream extent of flowlines is associated with stream headwaters formed by groundwater discharge (Jaeger et al. 2007). Geologic layers and the DEM used to prepare topographic layers were accessed from the Wyoming Geospatial Hub on 17 July 2023 (<span class="ot">&lt;https://data.geospatialhub.org/&gt;</span>). </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>We modeled the prevalence of groundwater springs using a logistic model with the default parameters, except for a default prevalence value of 0.1, as we expected springs to be uncommon at the landscape scale. Of the 182 spring locations, 70% (n = 128) were used for model training and 30% (n = 54) were used for model testing. We did not test for or exclude predictor variables that were correlated as our primary goal was to build a model with high predictive accuracy, rather than to make inference on the effect of any single variable. We assessed model performance by calculating the area under the receiver operating curve (AUC): the probability that a randomly chosen presence point will be ranked above a randomly chosen background location (Phillips and Dudík 2008). </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>While accounting for spatial bias in search effort can help increase the accuracy of MaxEnt modeling (Kramer-Schadt et al. 2013), we did not consider this necessary for three reasons. First, fieldwork over five years brought us to most areas within the USRW and we therefore did not think search effort was systematically biased towards certain locations. Second, combining field observations with the Groundwater Atlas of Wyoming increased our sample size of spring locations in high elevation, headwater areas that were difficult to access on foot. Third, the model output describing spring prevalence aligned well with our a priori understanding of groundwater activity in the region (refer to Study System and Species). Therefore, we considered the spatial clustering of spring locations to be a real pattern (sensu Winter 2001), rather than an artifact of unequal search effort. </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>From the MaxEnt model output (a raster of spring prevalence, where the value for each ca. 10 x 10 m cell represents the probability of the cell containing a groundwater spring), we derived a metric describing groundwater influence on stream conditions. We buffered (100 m radius) the prevalence raster to the stream network as we assumed only groundwater discharging from springs adjacent to flowlines exert influence on stream conditions, such as temperature. We then used WhiteboxTools to delineate catchments for 13,083 locations spaced every 300 m (the distance between study reaches) across the stream network (hereafter, network locations), 32 stream temperature monitoring locations, and 52 study reaches (the downstream extent of four reaches within each of the 13 focal streams). Deriving a metric of groundwater influence across the entire stream network was necessary to allow for projections of growth and production at this scale. We restricted network locations to those with catchments &lt;500 km2 as we assumed groundwater effects on ecosystem processes likely differ between large rivers and smaller tributary streams that were the focus of our study. For each watershed corresponding to either a network, temperature, or study location, we calculated a distance-weighted mean prevalence from the buffered spring prevalence raster. Our weighting scheme used inverse exponential weights with an e-folding distance (the distance at which the weight is 1/e) of 5 km (Isaak et al. 2010). This approach assumes that springs located immediately upstream of a given point exert the greatest influence on local stream conditions, while springs located further upstream are exponentially less likely to affect conditions at the location of interest. To aid interpretation, we normalized the metric of groundwater influence to 0-1 based on the minimum and maximum values calculated for the 13,083 network locations. We used the normalized, distance-weighted mean spring prevalence within the contributing catchment to describe relative groundwater influence at each network, temperature, or study location (hereafter, groundwater index or GWI).</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>The MaxEnt model describing groundwater spring prevalence performed well: model area under the curve (AUC) values were 0.93 for both training and testing data. In order of importance, spring prevalence was a function of distance to flowlines, bedrock geology, profile curvature range, surficial geology, elevation, and distance to geologic lineaments, with all other variables contributing little to no information (Table 1). Collectively, the model indicated that ***groundwater springs occurred near flowlines where topography changes abruptly over small distances in valley-bottom areas underlain by coarse glacial deposits*** (i.e., toe slopes formed by stream channel incision into unconsolidated alluvium and colluvium). While springs were predicted to be widespread throughout the upper Snake River watershed, they were most heavily concentrated in the southwestern, eastern, and northern portions of the study area, driving similar spatial patterns in derived GWI. Network locations with high GWI were rare at the scale of the upper Snake River watershed: locations with GWI &gt;0.5 represented just 2.8% of all locations for which the index was derived.</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Bivand, R., and C. Rundel. 2023. rgeos: Interface to Geometry Engine - Open Source ('GEOS'). R package version 0.6-3, https://CRAN.R-project.org/package=rgeos.</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Detty, J. M., and K. J. McGuire. 2010. Topographic controls on shallow groundwater dynamics: Implications of hydrologic connectivity between hillslopes and riparian zones in a till mantled catchment. Hydrological Processes 24:2222–2236.</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Dralle, D. N., G. Rossi, P. Georgakakos, W. J. Hahm, D. M. Rempe, M. Blanchard, M. E. Power, W. E. Dietrich, and S. M. Carlson. 2023. The salmonid and the subsurface: Hillslope storage capacity determines the quality and distribution of fish habitat. Ecosphere 14:1–23.</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Elith, J., S. J. Phillips, T. Hastie, M. Dudík, Y. E. Chee, and C. J. Yates. 2011. A statistical explanation of MaxEnt for ecologists. Diversity and Distributions 17:43–57.</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Evans, J. S., and M. A. Murphy. 2023. spatialEco. R package version 2.0-1, https://github.com/jeffreyevans/spatialEco.</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Gerlach, M. E., K. C. Rains, E. J. Guerrón-Orejuela, W. J. Kleindl, J. Downs, S. M. Landry, and M. C. Rains. 2022. Using remote sensing and machine learning to locate groundwater discharge to salmon-bearing streams. Remote Sensing 14.</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Haitjema, H. M., and S. Mitchell-Bruker. 2005. Are water tables a subdued replica of the topography? Ground Water 43:781–786.</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Hijmans, R. 2023. terra: Spatial Data Analysis. R package version 1.7-39, https://CRAN.R-project.org/package=terra.</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Isaak, D. J., C. H. Luce, B. E. Rieman, D. E. Nagel, E. E. Peterson, D. L. Horan, S. Parkes, and G. L. Chandler. 2010. Effects of climate change and wildfire on stream temperatures and salmonid thermal habitat in a mountain river network. Ecological Applications 20:1350–1371.</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Jaeger, K. L., D. R. Montgomery, and S. M. Bolton. 2007. Channel and perennial flow initiation in headwater streams: Management implications of variability in source-area size. Environmental Management 40:775–786.</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Kramer-Schadt, S., J. Niedballa, J. D. Pilgrim, B. Schröder, J. Lindenborn, V. Reinfelder, M. Stillfried, I. Heckmann, A. K. Scharf, D. M. Augeri, S. M. Cheyne, A. J. Hearn, J. Ross, D. W. Macdonald, J. Mathai, J. Eaton, A. J. Marshall, G. Semiadi, R. Rustam, H. Bernard, R. Alfred, H. Samejima, J. W. Duckworth, C. Breitenmoser-Wuersten, J. L. Belant, H. Hofer, and A. Wilting. 2013. The importance of correcting for sampling bias in MaxEnt species distribution models. Diversity and Distributions 19:1366–1379.</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Leach, J. A., W. Lidberg, L. Kuglerova, A. Peralta-Tapia, A. Agren, and H. Laudon. 2017. Evaluating topography-based predictions of shallow lateral groundwater discharge zones for a boreal lake-stream system. Water Resources Research 53:5420–5437.</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Love, J. D., and A. C. Christiansen. 1985. Geologic map of Wyoming: U.S. Geological Survey Geologic Map, scale 1:500,000, 3 sheets.</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Mallast, U., R. Gloaguen, S. Geyer, T. Rüdiger, and C. Siebert. 2011. Derivation of groundwater flow-paths based on semi-automatic extraction of lineaments from remote sensing data. Hydrology and Earth System Sciences 15:2665–2678.</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>O’Sullivan, A. M., K. J. Devito, J. Ogilvie, T. Linnansaari, T. Pronk, S. Allard, and R. A. Curry. 2020. Effects of Topographic Resolution and Geologic Setting on Spatial Statistical River Temperature Models. Water Resources Research 56:1–23.</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Phillips, S. J., and M. Dudík. 2008. Modeling of species distributions with Maxent: new extensions and a comprehensive evaluation. Ecography 31:161–175.</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Pourtaghi, Z. S., and H. R. Pourghasemi. 2014. GIS-based groundwater spring potential assessment and mapping in the Birjand Township, southern Khorasan Province, Iran. Hydrogeology Journal 22:643–662.</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Reid, M. E., and R. M. Iverson. 1992. Gravity‐driven groundwater flow and slope failure potential: 2. Effects of slope morphology, material properties, and hydraulic heterogeneity. Water Resources Research 28:939–950.</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Stevens, L. E., E. R. Schenk, and A. E. Springer. 2021. Springs ecosystem classification. Ecological Applications 31.</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Tague, C., M. Farrell, G. Grant, S. Lewis, and S. Rey. 2007. Hydrogeologic controls on summer stream temperatures in the McKenzie River basin, Oregon. Hydrological Processes 21:3288–3300.</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Winter, T. C. 1999. Relation of streams, lakes, and wetlands to groundwater flow systems. Hydrogeology Journal 7:28–45.</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Winter, T. C. 2001. The concept of hydrologic landscapes. Journal of the American Water Resources Association 37:335–349.</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>